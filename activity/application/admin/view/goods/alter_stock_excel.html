<include file="public/layout"/>
<!--物流配置 css -start-->
<script src="__ROOT__/public/static/js/layer/laydate/laydate.js"></script>
<style>
    ul.group-list {
        width: 96%;
        min-width: 1000px;
        margin: auto 5px;
        list-style: disc outside none;
    }

    .err {
        color: #F00;
        display: none;
    }

    ul.group-list li {
        white-space: nowrap;
        float: left;
        width: 150px;
        height: 25px;
        padding: 3px 5px;
        list-style-type: none;
        list-style-position: outside;
        border: 0px;
        margin: 0px;
    }

    .row .table-bordered td .btn, .row .table-bordered td img {
        vertical-align: middle;
    }

    .row .table-bordered td {
        padding: 8px;
        line-height: 1.42857143;
    }

    .table-bordered {
        width: 100%
    }

    .table-bordered tr td {
        border: 1px solid #f4f4f4;
    }

    .btn-success {
        color: #fff;
        background-color: #449d44;
        border-color: #398439 solid 1px;
    }

    .btn {
        display: inline-block;
        padding: 6px 12px;
        margin-bottom: 0;
        font-size: 14px;
        font-weight: 400;
        line-height: 1.42857143;
        text-align: center;
        white-space: nowrap;
        vertical-align: middle;
        -ms-touch-action: manipulation;
        touch-action: manipulation;
        cursor: pointer;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        background-image: none;
        border: 1px solid transparent;
        border-radius: 4px;
    }

    .col-xs-8 {
        width: 66.66666667%;
    }

    .col-xs-4 {
        width: 33.33333333%;
    }

    .col-xs-1, .col-xs-10, .col-xs-11, .col-xs-12, .col-xs-2, .col-xs-3, .col-xs-4, .col-xs-5, .col-xs-6, .col-xs-7, .col-xs-8, .col-xs-9 {
        float: left;
    }

    .row .tab-pane h4 {
        padding: 10px 0;
    }

    .row .tab-pane h4 input {
        vertical-align: middle;
    }

    .table-striped > tbody > tr:nth-of-type(odd) {
        background-color: #f9f9f9;
    }

    .ncap-form-default .title {
        border-bottom: 0
    }

    .ncap-form-default dl.row, .ncap-form-all dd.opt {
        /*border-color: #F0F0F0;*/
        border: none;
    }

    .ncap-form-default dl.row:hover, .ncap-form-all dd.opt:hover {
        border: none;
        box-shadow: inherit;
    }

    .p_plus strong {
        cursor: pointer;
        margin-left: 4px;
    }

    .excel_buttom {
        font-size: 12px;
        line-height: 30px;
        font-weight: bold;
        color: #FFF;
        background-color: #48CFAE;
        display: block;
        height: 30px;
        padding: 0 20px;
        border-radius: 3px;
        border: none 0;
        cursor: pointer;
        text-align: center;
    }

    .ncsc-form-goods {
        border: solid #E6E6E6;
        border-width: 1px 1px 0 1px;
    }

    .ncsc-form-goods dl {
        font-size: 0;
        *word-spacing: -1px;
        line-height: 20px;
        clear: both;
        padding: 0;
        margin: 0;
        border-bottom: solid 1px #E6E6E6;
        overflow: hidden;
    }

    .ncsc-form-goods dl dt {
        font-size: 12px;
        line-height: 30px;
        color: #333;
        vertical-align: top;
        letter-spacing: normal;
        word-spacing: normal;
        text-align: right;
        display: inline-block;
        width: 13%;
        padding: 8px 1% 8px 0;
        margin: 0;
    }

    .ncsc-form-goods dl dd {
        font-size: 12px;
        line-height: 30px;
        vertical-align: top;
        letter-spacing: normal;
        word-spacing: normal;
        display: inline-block;
        width: 84%;
        padding: 8px 0 8px 1%;
        border-left: solid 1px #E6E6E6;
    }

    .ncsc-form-goods dl dt i.required {
        font: 12px/16px Tahoma;
        color: #F30;
        vertical-align: middle;
        margin-right: 4px;
    }

    select, .select {
        color: #777;
        background-color: #FFF;
        height: 30px;
        vertical-align: middle;
        *display: inline;
        padding: 0 4px;
        border: solid 1px #E6E9EE;
        *zoom: 1;
    }

    .ncsc-default-table thead th {
        line-height: 20px;
        color: #999;
        background-color: #FFF;
        text-align: center;
        height: 20px;
        padding: 8px 0;
        border-bottom: solid 1px #DDD;
    }

    a.ncbtn {
        height: 20px;
        padding: 5px 10px;
        border-radius: 3px;
    }
    a.ncap-btn-big {
        font: bold 14px/20px "microsoft yahei",arial;
        background-color: #ECF0F1;
        text-align: center;
        vertical-align: middle;
        display: inline-block;
        height: 20px;
        padding: 7px 19px;
        border: solid 1px #BEC3C7;
        border-radius: 3px;
        cursor: pointer;
    }
    a.ncap-btn-green {
        background-color: #148eff;
        border-color: #148eff;
        display: inline-block;
        margin-top: -5px;
    }
    .bd-line td {
        border: solid 1px #f5eded;
        padding: 10px  0;
    }
    .w1 {
        text-align: center;
    }

</style>
<!--物流配置 css -end-->
<!--以下是在线编辑器 代码 -->
<load href="__ROOT__/public/plugins/Ueditor/ueditor.config.js"/>
<load href="__ROOT__/public/plugins/Ueditor/ueditor.all.min.js"/>
<script type="text/javascript" charset="utf-8" src="__ROOT__/public/plugins/Ueditor/lang/zh-cn/zh-cn.js"></script>
<!--以上是在线编辑器 代码  end-->
<body style="background-color: #FFF; overflow: auto;">
<div id="append_parent"></div>
<div id="ajaxwaitid"></div>
<div class="page">
    <div class="fixed-bar">
        <div class="item-title">
            <div class="subject">
                <h3>批量发货</h3>
                <h5>导入需要发货订单</h5>
            </div>
        </div>
    </div>
    <!-- 操作说明 -->
    <div class="explanation" id="">
        <div class="bckopa-tips">
            <div class="title">
                <img src="__PUBLIC__/static/images/handd.png" alt="">
                <h4 title="提示相关设置操作时应注意的要点">操作提示</h4>
            </div>
            <ul>
                <li>1.请将商品库存excel文件上传。<span style="color:red">(商品库存excel文件只需修改库存量)</span></li>
                <li>2.修改excel文件时请勿修改其表格结构、行列名称，修改完成后务必不要修改文件编码格式及文件后缀名.</li>
                <li>3.excel数据录入时如果某条商品不存在，将导入失败</li>
            </ul>
        </div>
        <span title="收起提示" id="explanationZoom" style="display: block;"></span>
    </div>
    <!--表单数据-->
    <form method="post" enctype="multipart/form-data" id="goods_form">
        <div class="ncsc-form-goods">
            <dl>
                <dt><i class="required">*</i>Excel文件：</dt>
                <dd>
                    <div class="handle">
                        <div class="ncsc-upload-btn">
                            <a href="javascript:void(0);">
                                <span>
                                    <input type="file" hidefocus="true" size="15" name="excel">
                                </span>
                            </a>
                        </div>
                    </div>
                </dd>
            </dl>
            <dl>
                <dt>&nbsp;</dt>
                <dd>
                    <input type="submit" class="submit excel_buttom" value="导入">
                </dd>
            </dl>
        </div>
    </form>
    <div style="width:800px;height:auto;overflow: hidden">
        <form id="send_form"  method="post">
            <table class="ncsc-default-table" style="width:795px">
                <thead>
                <tr>
                    <th class="w1" style="background-color:#dddddd">商品编号</th>
                    <th class="w2" style="background-color:#dddddd">商品名称</th>
                    <th class="w1" style="background-color:#dddddd">商品规格</th>
                    <th class="w1" style="background-color:#dddddd">库存</th>
                </tr>
                </thead>
                <tbody>
                    <volist name="goods" id="vo" key="k">
                        <tr class="bd-line">
                            <td class="w1 bor">{$vo.goods_sn}</td>
                            <td class="w1 bor">{$vo.goods_name}</td>
                            <td class="w1 bor">

                                <span style="">{$vo.key_name}</span>
                                <input type="hidden" name="good[{$k-1}][item_id]" value="{$vo.item_id}">
                            </td>
                            <td class="w1 bor">
                                <span style="">{$vo.store_count}</span>
                                <input type="hidden" name="good[{$k-1}][store_count]" value="{$vo.store_count}">
                            </td>
                        </tr>
                        <input type="hidden" name="good[{$k-1}][goods_id]" value="{$vo.goods_id}">
                    </volist>
                </tbody>
            </table>
        </form>
        <div class="tit" style="text-align:right;margin:20px 0 100px;">
            <a href="javascript:void(0)" class="ncbtn ncbtn-grapefruit mt5 ncap-btn-big ncap-btn-green" onclick="excel_stock()">确认修改库存</a>
        </div>
    </div>
</div>
<script>

function excel_stock(){
    // 确定
    $.ajax({
        type : 'post',
        url : "excelChangeStockVal",
        data : $('#send_form').serialize(),
        dataType : 'json',
        success : function(data){
            layer.closeAll();
            if(data.status==1){
                layer.msg(data.msg, {icon: 1, time: 2000});
                setTimeout(location.reload(),2000);
            }else{
                layer.msg(data.msg, {icon: 2,time: 2000});
            }
        }
    })

}
</script>
</body>
